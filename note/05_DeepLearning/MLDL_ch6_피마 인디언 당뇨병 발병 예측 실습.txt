Ch. 6 피마 인디언 당뇨병 발병 예측 실습

핵심 요약

1. 실습 흐름 (Process)

데이터 준비 → 모델 설계 → 학습 → 평가 및 분석의 정석적인 딥러닝 파이프라인.

1.1. 데이터 로드 및 확인:

- pandas로 CSV 파일을 읽어 결측치(isna())와 데이터 불균형(value_counts())을 확인.
- 실제 학습에는 numpy.loadtxt()를 사용하여 데이터를 배열(Array) 형태로 로드.

1.2. 데이터 전처리 (분할):

- 별도의 라이브러리(train_test_split)를 쓰지 않고, 슬라이싱([:620], [620:])을 통해 수동으로 학습용(Train)과 테스트용(Test) 데이터를 8:2 비율로 나눈다.

1.3. 모델 구성 (Architecture):

- 입력층(8개 변수) →  은닉층(32, 16 유닛) → 출력층(1 유닛)의 구조를 만든다.
- 핵심: 이진 분류이므로 마지막 활성화 함수는 Sigmoid를 사용한다.

1.4. 학습 설정 (Compile) & 실행:

- 손실 함수로 binary_crossentropy를 지정하고 학습(fit)을 수행한다.
- 학습 데이터의 10%를 검증용(validation_split=0.1)으로 떼어내어 과적합 여부를 모니터링한다.

1.5. 평가 및 시각화:

- evaluate()로 정확도를 확인하고, 그래프를 그려 Loss와 Accuracy의 변화를 확인한다.

1.6. 심화 분석 (혼동 행렬):

- 단순 정확도 외에 모델이 얼마나 잘 맞췄는지(TP, TN 등)를 확인하기 위해 혼동 행렬(Confusion Matrix)을 직접 코드로 계산해 봅니다.

---

2. 중요 코드 (Key Snippets)

① 데이터 로드 및 수동 분할

#python
#NumPy로 데이터 로드
dataset = np.loadtxt('data/pima-indians-diabetes.csv', delimiter=',')

#슬라이싱으로 학습/테스트 셋 분리 (수동 분할)
X_train = dataset[:620, :-1] #처음부터 620개 행까지 (독립변수)
y_train = dataset[:620, -1]  #마지막 열 (종속변수: 당뇨 발병 여부)


② 모델 구성 (이진 분류의 정석)

#python
model = Sequential()
model.add(Input(shape=(8,)))             #입력 변수 8개 (임신횟수, 혈압 등)
model.add(Dense(32, activation='relu'))
model.add(Dense(16, activation='elu'))   #다양한 활성화 함수 사용 (ELU)
#[핵심] 출력층: 0 또는 1, 하나의 확률값이므로 유닛=1, 함수=sigmoid
model.add(Dense(1, activation='sigmoid'))


③ 학습 설정 (Binary Crossentropy)

model.compile(loss='binary_crossentropy',  #이진 분류 전용 손실 함수
              optimizer='adam',
              metrics=['accuracy'])


④ 예측값 변환 (임계값 적용)

#python
#시그모이드 출력값(0~1 사이 확률)을 0.5 기준으로 0 또는 1로 변환
y_hat = (model.predict(X_test) >= 0.5).astype(int)


---

3. 핵심 개념 및 키워드

- 로지스틱 회귀 (Logistic Regression): 이름은 '회귀'지만 실제로는 데이터를 두 그룹(0/1)으로 나누는 '분류(Classification)' 기법.
- 시그모이드 (Sigmoid): 출력값을 0과 1 사이의 확률값으로 압축해 주는 함수(0.5보다 크면 1, 작으면 0으로 판단).
- 바이너리 크로스엔트로피 (Binary Crossentropy): 이진 분류 문제에서 정답(0/1)과 예측 확률 사이의 오차를 계산하는 공식.
- 혼동 행렬 (Confusion Matrix): 모델의 성능을 입체적으로 평가하는 지표.
    - 정확도(Accuracy): 전체 중 몇 개 맞췄나?
    - 정밀도(Precision): 내가 양성이라고 한 것 중 진짜 양성은?
    - 재현율(Recall): 실제 양성인 사람 중 내가 찾아낸 비율은? (암 환자 찾기 등에서 중요)
    - 실습 코드에서는 이 지표들을 직접 for문과 if문으로 계산하며 원리를 파악.