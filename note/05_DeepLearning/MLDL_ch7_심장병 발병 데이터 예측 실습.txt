Ch. 7 심장병 발병 데이터 예측 실습

이전 챕터(당뇨병 예측)에서 다룬 이진 분류(Binary Classification)를 심화하여, 결측치 처리와 과적합 방지(Dropout) 기법을 추가하고, 같은 문제를 두 가지 방식(로지스틱 회귀 vs 원-핫 인코딩 분류)으로 풀이

---

1. 실습 흐름 (Process)

Step 1: 데이터 전처리 (심화)

단순히 데이터를 로드하는 것을 넘어, '?'로 표시된 비표준 결측치를 처리하는 과정.

- 결측치 처리: 데이터에 포함된 물음표('?')를 찾아내어 np.nan으로 변환 후 삭제(dropna)한다.
- 스케일링: MinMaxScaler를 사용하여 데이터의 범위를 0~1 사이로 맞춘다.
- 데이터 분할: stratify=y 옵션을 사용하여 학습/테스트 데이터의 정답 비율을 일정하게 유지하며 분리.

Step 2: 방식 A - 로지스틱 회귀 (Logistic Regression)

- 구조: 출력층 노드 1개, 활성화 함수 Sigmoid.
- 손실 함수: binary_crossentropy.
- 특징: 0.5를 기준으로 0(정상)과 1(발병)을 나눈다.

Step 3: 방식 B - 분류 분석 (Classification with One-hot)

- 전처리 추가: 정답(y)을 원-핫 인코딩(to_categorical)하여 [0, 1] 형태로 변환한다.
- 구조: 출력층 노드 2개, 활성화 함수 Softmax.
- 손실 함수: categorical_crossentropy.
- 특징: [정상 확률, 발병 확률] 두 개의 값을 뱉어내고, 둘 중 큰 값(argmax)을 선택한다.

Step 4: 성능 평가 및 최적화

- 평가 지표: 정확도(Accuracy)뿐만 아니라 정밀도(Precision)와 재현율(Recall)을 함께 확인한다. (의료 데이터 특성상 재현율이 중요)
- 과적합 방지: 학습 그래프를 보며 검증 손실(Val Loss)이 튀는 것을 막기 위해 Dropout 레이어를 추가하고 비율을 조정한다.

---

2. 중요 코드 (Key Snippets)

① 비표준 결측치('?') 처리

[python]
#'?' 문자를 결측치(NaN)로 변환
df.replace('?', np.nan, inplace=True)
#결측치가 있는 행 제거
df = df.dropna(how='any')


② 층화 추출 (Stratified Split)

[python]
#정답(y)의 비율(환자/정상)을 유지하면서 데이터 분할
x_train, x_test, y_train, y_test = train_test_split(..., stratify=y)


③ 과적합 방지 (Dropout)

[python]
model.add(Dense(32, activation='tanh'))
model.add(Dropout(0.3)) #30%의 뉴런을 랜덤하게 끄고 학습 (과적합 방지)


④ 두 가지 분류 방식 비교

구분	로지스틱 회귀 (방식 A)		원-핫 인코딩 분류 (방식 B)
---	---				---
출력층	Dense(1, activation='sigmoid')	Dense(2, activation='softmax')
손실함수	'binary_crossentropy'		'categorical_crossentropy'
데이터	y=0 또는 1 (스칼라) 		y=[1, 0] 또는 [0, 1] (벡터)

---

3. 핵심 개념 및 키워드

- 비표준 결측치 (Non-standard Missing Values): NaN이 아닌 특수문자('?') 등으로 표기된 결측치. 이를 전처리하지 않으면 모델 학습 시 에러가 발생한다.
- Dropout (드롭아웃): 신경망의 일부 뉴런을 랜덤하게 끊어버려서, 특정 뉴런에 과도하게 의존하는 것을 막아 과적합(Overfitting)을 방지하는 핵심 기법.
- Softmax vs Sigmoid:
    - Sigmoid: "이 환자가 심장병일 확률은 70%다." (0~1 사이 값 1개)
    - Softmax: "이 환자는 정상일 확률 30%, 심장병일 확률 70%다." (합이 1이 되는 확률 분포)
    - 결국 같은 결과를 내지만, 문제에 접근하는 방식(이진 vs 다중 분류 구조)의 차이.
- 층화 추출 (Stratified Sampling): 암 환자 데이터처럼 특정 클래스가 적을 때, 학습/테스트 셋에 골고루 분포되도록 강제하는 샘플링 방식.