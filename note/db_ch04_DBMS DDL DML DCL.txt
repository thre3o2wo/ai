Ch. 4 DDL DML DCL

1. DDL (Data Definition Language, 데이터 정의어)

데이터베이스 객체(테이블 등)의 구조를 생성, 변경, 삭제하는 언어. 실행 즉시 자동 커밋(Auto Commit)되므로 되돌릴(Rollback) 수 없다.

- CREATE (생성)
    - 기본 생성: CREATE TABLE 테이블명 (컬럼명 타입(크기), ...);
    - 서브쿼리를 이용한 생성 (CTAS): CREATE TABLE ... AS SELECT ...
        - 기존 테이블의 구조와 데이터를 복사하여 새 테이블을 만든다.
        - 구조만 복사하고 싶을 때는 WHERE 1=0과 같은 거짓 조건을 사용한다.
        - 제약조건(PK 등)은 복사되지 않으므로 ALTER로 추가해야 한다.
- ALTER (변경)
    - 컬럼 추가: ADD (컬럼명 타입)
    - 컬럼 수정: MODIFY (컬럼명 타입) (데이터 크기는 늘릴 수만 있고, 줄이려면 데이터가 없어야 함)
    - 컬럼 삭제: DROP COLUMN 컬럼명 (부하가 크므로 사용 주의)
    - 컬럼 미사용 설정: SET UNUSED (컬럼명) (실제 삭제 대신 숨김 처리하여 부하를 줄임)
- DROP (삭제)
    - 테이블 자체를 삭제한다. (DROP TABLE 테이블명 PURGE;로 휴지통 없이 완전 삭제 가능)
- TRUNCATE (잘라내기)
    - 테이블 구조는 남기고 모든 데이터만 삭제한다.
    - DELETE와 달리 저장 공간까지 즉시 반납하며, 복구(Rollback)가 불가능한다.

---

2. 데이터 타입 (Data Types)

- CHAR(n): 고정 길이 문자열. 남는 공간을 공백으로 채움 (성능 우수, 공간 낭비).
- VARCHAR2(n): 가변 길이 문자열. 실제 데이터만큼만 공간 사용 (공간 효율 우수).
- NUMBER(p, s): 숫자형. p는 전체 자릿수, s는 소수점 이하 자릿수.
- DATE: 날짜형 (세기, 년, 월, 일, 시, 분, 초 포함).

---

3. DML (Data Manipulation Language, 데이터 조작어)

테이블 내의 데이터를 입력, 수정, 삭제하는 언어다. COMMIT하기 전까지는 트랜잭션이 완료되지 않아 ROLLBACK이 가능하다.

- INSERT (입력)
    - INSERT INTO 테이블명 (컬럼1, ...) VALUES (값1, ...);
    - 컬럼 리스트를 생략하면 테이블 생성 순서대로 모든 값을 입력해야 한다.
    - NULL 입력: 명시적으로 NULL을 적거나, 컬럼 리스트에서 제외한다(Default가 없으면 NULL).
- UPDATE (수정)
    - UPDATE 테이블명 SET 컬럼=값, ... WHERE 조건;
    - 주의: WHERE 절을 생략하면 테이블의 모든 행이 수정된다.
- DELETE (삭제)
    - DELETE FROM 테이블명 WHERE 조건;
    - 주의: WHERE 절을 생략하면 테이블의 모든 행이 삭제된다.
- MERGE (병합)
    - 조건에 따라 존재하면 UPDATE, 없으면 INSERT를 한 번에 수행한다.

---

4. 제약조건 (Constraints)

데이터의 무결성(정확성)을 보장하기 위한 규칙이다.

1. PRIMARY KEY (PK): 기본키. 유일성(Unique) + NOT NULL. 테이블당 1개만 존재 가능하며, 데이터를 식별하는 기준이 된다.
2. FOREIGN KEY (FK): 외래키. 다른 테이블의 PK를 참조한다. 참조 무결성을 보장한다.
3. UNIQUE (UK): 중복을 허용하지 않는다. (NULL은 허용)
4. NOT NULL (NN): NULL 값을 허용하지 않는다. (반드시 값이 있어야 함)
5. CHECK (CK): 특정 조건(범위, 값 등)을 만족하는 데이터만 허용한다.

---

5. TCL (Transaction Control Language)

- COMMIT: 변경된 데이터를 데이터베이스에 영구 저장한다.
- ROLLBACK: 마지막 커밋 시점 이후의 변경 사항을 취소하고 원래대로 되돌린다.
- 읽기 일관성: 한 사용자가 데이터를 변경 중(커밋 전)일 때, 다른 사용자는 변경 전의 데이터를 조회하게 하여 데이터의 일관성을 유지하는 기능이다.